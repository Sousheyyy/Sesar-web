(()=>{var e={};e.id=5688,e.ids=[5688],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},78893:e=>{"use strict";e.exports=require("buffer")},20283:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>s.Z,__next_app__:()=>u,originalPathname:()=>d,pages:()=>c,routeModule:()=>f,tree:()=>i}),r(32693),r(40951),r(77564),r(26083),r(96560);var n=r(23191),a=r(88716),s=r(48001),o=r(95231),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let i=["",{children:["(dashboard)",{children:["profile",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,32693)),"C:\\Users\\ilker\\Desktop\\sesar-web\\app\\(dashboard)\\profile\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,40951)),"C:\\Users\\ilker\\Desktop\\sesar-web\\app\\(dashboard)\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,77564)),"C:\\Users\\ilker\\Desktop\\sesar-web\\app\\layout.tsx"],error:[()=>Promise.resolve().then(r.bind(r,26083)),"C:\\Users\\ilker\\Desktop\\sesar-web\\app\\error.tsx"],"not-found":[()=>Promise.resolve().then(r.bind(r,96560)),"C:\\Users\\ilker\\Desktop\\sesar-web\\app\\not-found.tsx"]}],c=["C:\\Users\\ilker\\Desktop\\sesar-web\\app\\(dashboard)\\profile\\page.tsx"],d="/(dashboard)/profile/page",u={require:r,loadChunk:()=>Promise.resolve()},f=new n.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/(dashboard)/profile/page",pathname:"/profile",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},75859:(e,t,r)=>{Promise.resolve().then(r.bind(r,83251))},83251:(e,t,r)=>{"use strict";r.d(t,{TikTokConnect:()=>y});var n=r(10326),a=r(17577),s=r(44064),o=r.n(s),l=r(90772),i=r(33071),c=r(567),d=r(77506),u=r(66307),f=r(71810),p=r(41291),h=r(85999),m=r(35047);function y(){let e=(0,m.useRouter)();(0,m.useSearchParams)();let[t,r]=(0,a.useState)(!1),[s,y]=(0,a.useState)(!0),[g,x]=(0,a.useState)(!1),[b,v]=(0,a.useState)(null),k=async(e,t)=>{try{console.log("[Phyllo] Processing connected accounts:",{userId:e,accounts:t});let r=await fetch("/api/auth/insightiq/process-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,accounts:t})});if(r.ok)h.Am.success("TikTok hesabı başarıyla bağlandı!"),j();else{let e=await r.json();console.error("[Phyllo] Process connection error:",e),h.Am.error("Bağlantı işlenirken hata oluştu")}}catch(e){console.error("[Phyllo] Failed to process connection:",e),h.Am.error("Bağlantı işlenirken hata oluştu")}},j=async()=>{try{let e=await fetch("/api/auth/insightiq/status"),t=await e.json();t.success&&v({connected:t.connected,user:t.user})}catch(e){console.error("Status check failed:",e)}finally{y(!1)}},w=(0,a.useCallback)(()=>{console.log("[Phyllo] SDK loaded successfully"),window.PhylloConnect&&(console.log("[Phyllo] SDK version:",window.PhylloConnect.version()),x(!0))},[]),P=(0,a.useCallback)(e=>{console.error("[Phyllo] SDK failed to load:",e),h.Am.error("Bağlantı SDK'sı y\xfcklenemedi")},[]),N=async()=>{r(!0);try{if(console.log("[Phyllo] Starting connection flow (popup)..."),!window.PhylloConnect)throw Error("Phyllo SDK hen\xfcz y\xfcklenmedi. L\xfctfen sayfayı yenileyin.");let e=await fetch("/api/auth/insightiq/initiate",{method:"POST"}),t=await e.json();if(console.log("[Phyllo] Backend response:",t),!t.success)throw Error(t.message||t.error||"Bağlantı başlatılamadı");let n=t.environment||"staging",a={clientDisplayName:"Sesar",environment:n,userId:t.userId,token:t.token,singleAccount:!1,redirect:!1,workPlatformId:t.workPlatformId};console.log("[Phyllo] Initializing SDK with config:",{...a,token:"***"});let s=window.PhylloConnect.initialize(a);s.on("accountConnected",(e,t,r)=>{console.log("[Phyllo] Account connected:",{accountId:e,workPlatformId:t,userId:r}),k(r,[{account_id:e,work_platform_id:t}])}),s.on("accountDisconnected",(e,t,r)=>{console.log("[Phyllo] Account disconnected:",{accountId:e,workPlatformId:t,userId:r}),h.Am.info("Hesap bağlantısı kesildi"),j()}),s.on("tokenExpired",e=>{console.log("[Phyllo] Token expired for user:",e),h.Am.error("Oturum s\xfcresi doldu. L\xfctfen tekrar deneyin."),r(!1)}),s.on("exit",(e,t)=>{console.log("[Phyllo] SDK exited:",{reason:e,userId:t}),r(!1),"DONE_CLICKED"===e?j():"TOKEN_EXPIRED"===e?h.Am.error("Oturum s\xfcresi doldu"):console.log("[Phyllo] User closed the popup:",e)}),s.on("connectionFailure",(e,t,r)=>{console.log("[Phyllo] Connection failed:",{reason:e,workPlatformId:t,userId:r}),h.Am.error(`Bağlantı başarısız: ${e}`)}),console.log("[Phyllo] Opening SDK popup..."),s.open()}catch(e){console.error("[Phyllo] Connection error:",e),h.Am.error(e.message||"Bir hata oluştu"),r(!1)}},_=async()=>{if(confirm("TikTok hesabınızın bağlantısını kesmek istediğinize emin misiniz?")){r(!0);try{if((await fetch("/api/auth/insightiq/disconnect",{method:"POST"})).ok)v({connected:!1}),h.Am.success("Bağlantı kesildi"),e.refresh();else throw Error("Bağlantı kesilemedi")}catch(e){h.Am.error("Bir hata oluştu")}finally{r(!1)}}};return s?n.jsx(i.Zb,{children:n.jsx(i.aY,{className:"pt-6",children:n.jsx("div",{className:"flex items-center justify-center p-4",children:n.jsx(d.Z,{className:"h-6 w-6 animate-spin text-muted-foreground"})})})}):(0,n.jsxs)(n.Fragment,{children:[n.jsx(o(),{src:"https://cdn.getphyllo.com/connect/v2/phyllo-connect.js",strategy:"afterInteractive",onLoad:w,onError:P}),(0,n.jsxs)(i.Zb,{children:[n.jsx(i.Ol,{children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[n.jsx(i.ll,{children:"TikTok Bağlantısı"}),n.jsx(i.SZ,{children:"Kampanyalar oluşturmak ve şarkılarınızı y\xf6netmek i\xe7in TikTok hesabınızı bağlayın"})]}),b?.connected&&(0,n.jsxs)(c.C,{variant:"secondary",className:"bg-green-100 text-green-800 hover:bg-green-100",children:[n.jsx(u.Z,{className:"h-3 w-3 mr-1"}),"Bağlı"]})]})}),n.jsx(i.aY,{children:b?.connected?(0,n.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-muted/30",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[b.user?.avatarUrl?n.jsx("img",{src:b.user.avatarUrl,alt:"Avatar",className:"h-12 w-12 rounded-full border"}):n.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-200 flex items-center justify-center",children:n.jsx("span",{className:"text-xl font-bold text-slate-500",children:b.user?.displayName?.charAt(0)||"T"})}),(0,n.jsxs)("div",{children:[n.jsx("p",{className:"font-semibold",children:b.user?.displayName}),(0,n.jsxs)("p",{className:"text-sm text-muted-foreground",children:["@",b.user?.username]})]})]}),(0,n.jsxs)(l.z,{variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:_,disabled:t,children:[n.jsx(f.Z,{className:"h-4 w-4 mr-2"}),"Bağlantıyı Kes"]})]}):(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2 p-3 text-sm text-amber-600 bg-amber-50 rounded-md border border-amber-200",children:[n.jsx(p.Z,{className:"h-4 w-4 shrink-0"}),n.jsx("p",{children:"Şarkılarınızı otomatik olarak doğrulamak i\xe7in hesabınızı bağlamanız gerekmektedir."})]}),n.jsx(l.z,{className:"w-full bg-black hover:bg-black/90 text-white gap-2",onClick:N,disabled:t,children:t?(0,n.jsxs)(n.Fragment,{children:[n.jsx(d.Z,{className:"h-4 w-4 animate-spin"}),"Bağlanıyor..."]}):(0,n.jsxs)(n.Fragment,{children:[n.jsx("svg",{className:"h-5 w-5 fill-current",viewBox:"0 0 24 24",children:n.jsx("path",{d:"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"})}),"TikTok ile Bağlan"]})})]})})]})]})}},567:(e,t,r)=>{"use strict";r.d(t,{C:()=>l});var n=r(10326);r(17577);var a=r(79360),s=r(77863);let o=(0,a.j)("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white shadow hover:bg-green-600",warning:"border-transparent bg-yellow-500 text-white shadow hover:bg-yellow-600"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...r}){return n.jsx("div",{className:(0,s.cn)(o({variant:t}),e),...r})}},33071:(e,t,r)=>{"use strict";r.d(t,{Ol:()=>l,SZ:()=>c,Zb:()=>o,aY:()=>d,ll:()=>i});var n=r(10326),a=r(17577),s=r(77863);let o=a.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:(0,s.cn)("rounded-xl border bg-card text-card-foreground shadow",e),...t}));o.displayName="Card";let l=a.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",e),...t}));l.displayName="CardHeader";let i=a.forwardRef(({className:e,...t},r)=>n.jsx("h3",{ref:r,className:(0,s.cn)("font-semibold leading-none tracking-tight",e),...t}));i.displayName="CardTitle";let c=a.forwardRef(({className:e,...t},r)=>n.jsx("p",{ref:r,className:(0,s.cn)("text-sm text-muted-foreground",e),...t}));c.displayName="CardDescription";let d=a.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:(0,s.cn)("p-6 pt-0",e),...t}));d.displayName="CardContent",a.forwardRef(({className:e,...t},r)=>n.jsx("div",{ref:r,className:(0,s.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},66307:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(62881).Z)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},77506:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});let n=(0,r(62881).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},69374:(e,t)=>{"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{DOMAttributeNames:function(){return n},default:function(){return o},isEqualNode:function(){return s}});let n={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",noModule:"noModule"};function a(e){let{type:t,props:r}=e,a=document.createElement(t);for(let e in r){if(!r.hasOwnProperty(e)||"children"===e||"dangerouslySetInnerHTML"===e||void 0===r[e])continue;let s=n[e]||e.toLowerCase();"script"===t&&("async"===s||"defer"===s||"noModule"===s)?a[s]=!!r[e]:a.setAttribute(s,r[e])}let{children:s,dangerouslySetInnerHTML:o}=r;return o?a.innerHTML=o.__html||"":s&&(a.textContent="string"==typeof s?s:Array.isArray(s)?s.join(""):""),a}function s(e,t){if(e instanceof HTMLElement&&t instanceof HTMLElement){let r=t.getAttribute("nonce");if(r&&!e.getAttribute("nonce")){let n=t.cloneNode(!0);return n.setAttribute("nonce",""),n.nonce=r,r===e.nonce&&e.isEqualNode(n)}}return e.isEqualNode(t)}function o(){return{mountedInstances:new Set,updateHead:e=>{let t={};e.forEach(e=>{if("link"===e.type&&e.props["data-optimized-fonts"]){if(document.querySelector('style[data-href="'+e.props["data-href"]+'"]'))return;e.props.href=e.props["data-href"],e.props["data-href"]=void 0}let r=t[e.type]||[];r.push(e),t[e.type]=r});let n=t.title?t.title[0]:null,a="";if(n){let{children:e}=n.props;a="string"==typeof e?e:Array.isArray(e)?e.join(""):""}a!==document.title&&(document.title=a),["meta","base","link","style","script"].forEach(e=>{r(e,t[e]||[])})}}}r=(e,t)=>{let r=document.getElementsByTagName("head")[0],n=r.querySelector("meta[name=next-head-count]"),o=Number(n.content),l=[];for(let t=0,r=n.previousElementSibling;t<o;t++,r=(null==r?void 0:r.previousElementSibling)||null){var i;(null==r?void 0:null==(i=r.tagName)?void 0:i.toLowerCase())===e&&l.push(r)}let c=t.map(a).filter(e=>{for(let t=0,r=l.length;t<r;t++)if(s(l[t],e))return l.splice(t,1),!1;return!0});l.forEach(e=>{var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),c.forEach(e=>r.insertBefore(e,n)),n.content=(o-l.length+c.length).toString()},("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},44064:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return b},handleClientScriptLoad:function(){return y},initScriptLoader:function(){return g}});let n=r(91174),a=r(58374),s=r(10326),o=n._(r(60962)),l=a._(r(17577)),i=r(81157),c=r(69374),d=r(10956),u=new Map,f=new Set,p=["onLoad","onReady","dangerouslySetInnerHTML","children","onError","strategy","stylesheets"],h=e=>{if(o.default.preinit){e.forEach(e=>{o.default.preinit(e,{as:"style"})});return}},m=e=>{let{src:t,id:r,onLoad:n=()=>{},onReady:a=null,dangerouslySetInnerHTML:s,children:o="",strategy:l="afterInteractive",onError:i,stylesheets:d}=e,m=r||t;if(m&&f.has(m))return;if(u.has(t)){f.add(m),u.get(t).then(n,i);return}let y=()=>{a&&a(),f.add(m)},g=document.createElement("script"),x=new Promise((e,t)=>{g.addEventListener("load",function(t){e(),n&&n.call(this,t),y()}),g.addEventListener("error",function(e){t(e)})}).catch(function(e){i&&i(e)});for(let[r,n]of(s?(g.innerHTML=s.__html||"",y()):o?(g.textContent="string"==typeof o?o:Array.isArray(o)?o.join(""):"",y()):t&&(g.src=t,u.set(t,x)),Object.entries(e))){if(void 0===n||p.includes(r))continue;let e=c.DOMAttributeNames[r]||r.toLowerCase();g.setAttribute(e,n)}"worker"===l&&g.setAttribute("type","text/partytown"),g.setAttribute("data-nscript",l),d&&h(d),document.body.appendChild(g)};function y(e){let{strategy:t="afterInteractive"}=e;"lazyOnload"===t?window.addEventListener("load",()=>{(0,d.requestIdleCallback)(()=>m(e))}):m(e)}function g(e){e.forEach(y),[...document.querySelectorAll('[data-nscript="beforeInteractive"]'),...document.querySelectorAll('[data-nscript="beforePageRender"]')].forEach(e=>{let t=e.id||e.getAttribute("src");f.add(t)})}function x(e){let{id:t,src:r="",onLoad:n=()=>{},onReady:a=null,strategy:c="afterInteractive",onError:u,stylesheets:p,...h}=e,{updateScripts:y,scripts:g,getIsSsr:x,appDir:b,nonce:v}=(0,l.useContext)(i.HeadManagerContext),k=(0,l.useRef)(!1);(0,l.useEffect)(()=>{let e=t||r;k.current||(a&&e&&f.has(e)&&a(),k.current=!0)},[a,t,r]);let j=(0,l.useRef)(!1);if((0,l.useEffect)(()=>{!j.current&&("afterInteractive"===c?m(e):"lazyOnload"===c&&("complete"===document.readyState?(0,d.requestIdleCallback)(()=>m(e)):window.addEventListener("load",()=>{(0,d.requestIdleCallback)(()=>m(e))})),j.current=!0)},[e,c]),("beforeInteractive"===c||"worker"===c)&&(y?(g[c]=(g[c]||[]).concat([{id:t,src:r,onLoad:n,onReady:a,onError:u,...h}]),y(g)):x&&x()?f.add(t||r):x&&!x()&&m(e)),b){if(p&&p.forEach(e=>{o.default.preinit(e,{as:"style"})}),"beforeInteractive"===c)return r?(o.default.preload(r,h.integrity?{as:"script",integrity:h.integrity,nonce:v,crossOrigin:h.crossOrigin}:{as:"script",nonce:v,crossOrigin:h.crossOrigin}),(0,s.jsx)("script",{nonce:v,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([r,{...h,id:t}])+")"}})):(h.dangerouslySetInnerHTML&&(h.children=h.dangerouslySetInnerHTML.__html,delete h.dangerouslySetInnerHTML),(0,s.jsx)("script",{nonce:v,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([0,{...h,id:t}])+")"}}));"afterInteractive"===c&&r&&o.default.preload(r,h.integrity?{as:"script",integrity:h.integrity,nonce:v,crossOrigin:h.crossOrigin}:{as:"script",nonce:v,crossOrigin:h.crossOrigin})}return null}Object.defineProperty(x,"__nextScript",{value:!0});let b=x;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},81157:(e,t,r)=>{"use strict";e.exports=r(81616).vendored.contexts.HeadManagerContext},32693:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i,dynamic:()=>l});var n=r(19510),a=r(84427),s=r(72331);let o=(0,r(68570).createProxy)(String.raw`C:\Users\ilker\Desktop\sesar-web\components\profile\tiktok-connect.tsx#TikTokConnect`),l="force-dynamic";async function i(){let e=await (0,a.mk)();return await s.prisma.user.findUnique({where:{id:e.id},select:{tiktokHandle:!0,email:!0,createdAt:!0}})?(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{children:[n.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Profil"}),n.jsx("p",{className:"text-muted-foreground",children:"Hesap ayarlarınızı y\xf6netin"})]}),n.jsx(o,{})]}):n.jsx("div",{className:"space-y-6",children:(0,n.jsxs)("div",{children:[n.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Profil"}),n.jsx("p",{className:"text-muted-foreground",children:"Kullanıcı bulunamadı"})]})})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[8948,958,6978,5383,2736,9137],()=>r(20283));module.exports=n})();